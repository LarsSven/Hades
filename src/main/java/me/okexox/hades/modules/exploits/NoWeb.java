package me.okexox.hades.modules.exploits;

import me.okexox.hades.data.PlayerData;
import me.okexox.hades.modules.base.Detection;
import me.okexox.hades.modules.base.DetectionType;
import me.okexox.hades.modules.base.FlagType;
import me.okexox.hades.modules.base.interfaces.CheckMove;
import me.okexox.hades.utility.BasicFunctions;
import me.okexox.hades.utility.Settings;
import org.bukkit.Material;
import org.bukkit.event.player.PlayerMoveEvent;

public class NoWeb extends Detection implements CheckMove {
    public NoWeb() {
        super("NoWeb", FlagType.Ban, DetectionType.Exploit);
    }

    @Override
    public void check(PlayerMoveEvent e, PlayerData data) {
        if(!e.getFrom().getBlock().getType().equals(Material.WEB)
           || !e.getTo().getBlock().getType().equals(Material.WEB)
           || data.isFlying()
        ) {
            return;
        }

        double speed = BasicFunctions.getHorizontalDistance(e.getTo(), e.getFrom());
        double maxSpeed = Settings.COB_SPEED + data.getSpeed() * 0.05;
        if(speed > maxSpeed) {
            flag(e, e.getPlayer(), "speed=" + speed);
        }
    }
}
